<!DOCTYPE html>
<html>
<head>
    <title>Lusaka Weather App</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="keywords" content="Lusaka Weather | Lusaka Weather Forecast | In Lusaka" />
    <meta name="author" content="David Kunda">
    <meta name="description" content="Lusaka Province Weather Application" />
    <link rel="stylesheet" type="text/css" href="./css/fontawesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="./css/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="./css/color.css" />
    <script type="text/javascript" src="./js/jquery.js"></script>
</head>
<body>
    <main>
        <header class="banner" id="banner">
            <div class="banner-fader">
                <div class="main-nav-bg">
                    <div class="container">
                        <nav class="main-nav">
                            <div class="icon-logos">
                                <a href="index.html" class="logo">
                                   <div class="text-logo"> <i class="fa fa-recycle"></i> Lusaka<br>Province</div>
                                </a>
                            </div>
                            <div class="nav-menu">
                                <ul>
                                    <li class="nav-item"><a href="index.html?#about">About Us</a></li>
                                    <li class="nav-item"><a href="index.html?#search-wrapper">Enlisted Cities</a></li>
                                    <li class="nav-item"><a href="index.html?#current-city">Your Residency</a></li>
                                    <li class="nav-item"><a href="index.html?#five-days-forecast">Five Days Forecast</a></li>
                                    <li class="nav-item"><a href="index.html?#search-wrapper"><i class="fa fa-search search-"></i></a></li>
                                    <li class="mob-nav-menu"><a><i class="fa fa-bars"></i></a></li>
                                </ul>
                            </div>
                        </nav>
                    </div>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="banner-text-wrap">
                            <div class="banner-text">
                                <h2 class="banner-text-title">LUSAKA PROVINCE WEATHER APP</h2>
                                <p class="banner-text-desc">
                                    Lusaka, the capital city of Zambia, experiences a subtropical highland climate 
                                    with distinct wet and dry seasons.
                                    Temperatures are cooler during this period, especially from June to August,
                                    rainfall is minimal to non-existent during the dry season, contributing to clear 
                                     skies and sunny days
                                </p>
                               
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <div class="sp-manager">
            <section class="current-city" id="current-city">
                <div class="container">
                    <div class="cc-text-titles">
                        <h3 class="cc-title">WEATHER CONDITIONS IN YOUR RESIDENCY</h3>
                        <p class="cc-title-desc">
                            The climate in Lusaka is influenced by its elevation (1,300 meters or about 4,265 
                            feet above sea level), which results in cooler temperatures compared to other regions 
                            at lower elevations in Zambia.
                        </p>
                    </div>
                </div>
                <div class="container">
                    <div class="cup-board cup-board-001">
                        <div class="cup-text">
                            <h4><strong>Temperature And Wind</strong></h4>
                            <p>
                                Temperatures are cooler during this period, especially from June to August. Daily averages range from 12°C (54°F) in the early morning to 26°C (79°F) during the day.
                            </p>
                            <a href="" class="btn btn-sm btn-primary"><i class="fa fa-recycle"></i> Explore More</a>
                        </div>
                        <div class="cup-cards">
                            <div class="current-city-wrap row-sp-end">
                                <div class="current-city-card shadow">
                                    <h1 id="current-city-temp-level" class="condition-level current-city-level">0</h1>
                                    <i class="fa fa-thermometer"></i>
                                    <p class="current-city-card-desc">
                                        <strong><h4>Temperature<br> Condition</h4></strong>
                                    </p>
                                </div>
                                <div class="current-city-card shadow">
                                    <h1 id="current-city-windy-level" class="condition-level current-city-level">0</h1>
                                    <i class="fa fa-snowflake"></i>
                                    <p class="current-city-card-desc">
                                        <strong><h4>Wind <br> Condition</h4></strong>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="cup-board cup-board-002">
                        <div class="cup-text">
                            <h4><strong>Cloudy And Humidity</strong></h4>
                            <p>
                                The air is dry, and conditions are generally more comfortable compared to the wet season.
                                The humidity is high, making the weather feel warmer and muggy.
                            </p>
                            <a href="" class="btn btn-sm btn-primary"><i class="fa fa-recycle"></i> Explore More</a>

                        </div>
                        <div class="cup-cards">
                            <div class="current-city-wrap row-sp-end">
                                <div class="current-city-card shadow">
                                    <h1 id="current-city-humidity-level" class="condition-level current-city-level">0</h1>
                                    <i class="fa fa-cloud-sun"></i>
                                    <p class="current-city-card-desc">
                                        <strong><h4>Humidity <br> Condition</h4></strong>
                                    </p>
                                </div>
                                <div class="current-city-card shadow">
                                    <h1 id="current-city-cloudy-level" class="condition-level current-city-level">0</h1>
                                    <i class="fa fa-cloud-rain"></i>
                                    <p class="current-city-card-desc">
                                        <strong><h4>Cloudy <br> Condition</h4></strong>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="current-city-wrap row-sp-evn">
                        <!-- <div class="current-city-card shadow">
                            <h1 id="current-city-temp-level" class="condition-level current-city-level">0</h1>
                            <i class="fa fa-thermometer"></i>
                            <p class="current-city-card-desc">
                                <strong><h4>Temperature<br> Condition</h4></strong>
                            </p>
                        </div>
                        <div class="current-city-card shadow">
                            <h1 id="current-city-windy-level" class="condition-level current-city-level">0</h1>
                            <i class="fa fa-snowflake"></i>
                            <p class="current-city-card-desc">
                                <strong><h4>Wind <br> Condition</h4></strong>
                            </p>
                        </div> -->
                        <!-- <div class="current-city-card shadow">
                            <h1 id="current-city-humidity-level" class="condition-level current-city-level">0</h1>
                            <i class="fa fa-cloud-sun"></i>
                            <p class="current-city-card-desc">
                                <strong><h4>Humidity <br> Condition</h4></strong>
                            </p>
                        </div>
                        <div class="current-city-card shadow">
                            <h1 id="current-city-cloudy-level" class="condition-level current-city-level">0</h1>
                            <i class="fa fa-cloud-rain"></i>
                            <p class="current-city-card-desc">
                                <strong><h4>Cloudy <br> Condition</h4></strong>
                            </p>
                        </div> -->
                    </div>
                </div>
            </section>
            <section class="search-wrapper" id="search-wrapper">
                <div class="container">
                    <div class="row">
                        <div class="search-themes">
                            <h4 class="search-theme">BEGIN YOUR SEARCH JOURNEY!</h4>
                            <p class="search-desc">
                                Search and know about weather. October marks the transition from the dry season to the rainy season, with 
                                increasing temperatures and occasional light showers as the weather shifts.
                            </p>
                        </div>
                    </div>
                    <div class="row search-results">
                        <div class="search-canvas">
                            <div class="err-display" id="err-display"></div>
                            <form action="" method="get">
                                <input type="text" 
                                        name="search" 
                                        id="search" 
                                        class="form-control"
                                        placeholder="start searching now..." />
                                <button type="button"  
                                        id="search-btn" 
                                        class="form-control btn btn-primary btn-sm weather-button">
                                        Instant Search <i class="fa fa-search"></i>
                                </button>
                                <span class="city-indicator-wrap" id="city-indicator-wrap"></span>
                            </form>
                        </div>
                        <div class="searched-canvas">
                            <div class="searched-canvas-results-wrap">
                                <div class="result">
                                    <i class="fa fa-thermometer"></i>
                                    <strong>Temperature<br>Level</strong>
                                    <span id="temp-level" class="condition-level"><span id="changeable-temp">0</span></span>
                                </div>
                                <div class="result">
                                    <i class="fa fa-snowflake"></i>
                                    <strong>WindSpeed <br>Level</strong>
                                    <span id="windy-level" class="condition-level">0</span>
                                </div>
                                <div class="result">
                                    <i class="fa fa-cloud"></i>
                                    <strong>Cloudy<br>Level</strong>
                                    <span id="cloudy-level" class="condition-level">0</span>
                                </div>
                                <div class="result">
                                    <i class="fa fa-cloud-rain"></i>
                                    <strong>Pressure<br>Level</strong>
                                    <span id="pressure-level" class="condition-level">0</span>
                                </div>
                                <div class="result">
                                    <i class="fa fa-cloud-sun"></i>
                                    <strong>Humidity<br>Level </strong>
                                    <span id="humidity-level" class="condition-level">0</span>
                                </div>
                            </div>
                            <div class="searched-canvas-buttons-wrap">
                                <button type="button" 
                                        id="fav-city" 
                                        class="form-control btn btn-primary btn-sm weather-button">
                                        List Town  <i class="fa fa-heart"></i>
                                </button>
                                <button type="button" 
                                        id="conver-units-btn" 
                                        class="form-control btn btn-primary btn-sm weather-button">
                                        Convert - Fahrenheit  <i class="fa fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <section class="about-wrap" id="about">
                <div class="container">
                    <div class="row justify-content-center">
                        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 about-desc">
                            <div class="about-dsc-text" style="color:white;">
                                <h2><strong>About Our Weather App?</strong></h2>
                                    Weather apps are beneficial for planning activities, 
                                    traveling, and preparing for severe weather events. 
                                    They help users make informed decisions about their daily 
                                    schedules and safety.    
                                <br>
                            </div>
                            <br>
                            <a href="" class="btn btn-sm btn-primary">Learn more <i class="fa fa-users"></i></a>
                        </div>
                        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 about-socials text-center">
                           <ul style="text-align:center;">
                                <li>We offer search service</li>
                                <li>We offer daily updates</li>
                                <li>We offer five days forecast</li>
                                <li>We offer email updates</li>
                                <li>We offer warning updates </li>
                           </ul>
                        </div>
                    </div>
                </div>
            </section>
            <section class="services sect-pd" id="five-days-forecast">
                <div class="container">
                    <div class="hd-text-title">
                        <h3 class="hd-title">FREE FIVE DAYS FOCUS</h3>
                        <p class="hd-title-desc">
                            Offers forecasts, live radar, and severe weather alerts.
                            Got your day ahead, what’s the weather say.
                            Rain or shine, we’ll help you plan.
                        </p>
                    </div>
                </div>
                <div class="container-fluid">
                    <div class="row justify-content-center" id="five-day-focus-wrapper"></div>
                </div>
            </section>
            <footer class="footer-wraper" style="background-color: #000000;">
                <div class="footer-fader">
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 text-center">
                                <div class="footer-contact" style="margin-bottom:20%;">
                                    <h6>EXPLORE YOUR CHOICES</h6>
                                    <ul class="list-group">
                                        <li class="nav-item"><a href="index.html">Home</a></li>
                                        <li class="nav-item"><a href="index.html?#about">About Us</a></li>
                                        <li class="nav-item"><a href="index.html?#search-wrapper">Enlisted Cities</a></li>
                                        <li class="nav-item"><a href="index.html?#current-city">Your Residency</a></li>
                                        <li class="nav-item"><a href="index.html?#five-days-forecast">Five Days Forecast</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 text-center">
                                <div class="footer-contact" style="margin-bottom:20%;">
                                    <h6>OUR SERVICES</h6>
                                    <ul class="list-group">
                                        <li class="nav-item-2"><a href="index.html">Local Search</a></li>
                                        <li class="nav-item-2"><a href="index.html"></a>International Search</li>
                                        <li class="nav-item-2"><a href="index.html">Five Days Forecast</a></li>
                                        <li class="nav-item-2"><a href="index.html">Dynamic Content</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 text-center">
                                <div class="footer-contact">
                                    <h6>forums</h6>
                                    <ul class="list-group"> 
                                        <li class="nav-item"><a href="https://www.icuzambia.net">ICU Zambia</a></li>
                                        <li class="nav-item"><a href="https://www.zrdc.org">ZRDC</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div> 
                        <div class="row salutation">
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                                <div class="signature text-center">
                                    &copy;2024.All Rights Reserved. Developed By David Kunda, SIN:2309869726 , BSc. Information Communications and Technology in System Engineering.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </main>
    <div class="nav-menu-slide">
        <div class="nm-slide-title row-sp-btn">
            <h4><strong>MENU</strong></h4>
            <span class="exit-slide-menu">x</span>
        </div>
        <ul>
            <li class="nav-item-2"><a href="index.html?#about">About Us</a></li>
            <li class="nav-item-2"><a href="index.html?#search-wrapper">Enlisted Cities</a></li>
            <li class="nav-item-2"><a href="index.html?#current-city">Your Residency</a></li>
            <li class="nav-item-2"><a href="index.html?#five-days-forecast">Five Days Forecast</a></li>
        </ul>
    </div>
    <script src="./js/menu.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script>
        //User current city information
        let coords = {
            "lat":"",
            "lng":"",
            "city":""
        };

        //get user current city details
        $.ajax({
            type: "GET",
            url: "https://geolocation-db.com/json/",
            async: true,
            success: function(data){
                let location = JSON.parse(data);
                coords.lat = location.latitude;
                coords.lng = location.longitude;
                coords.city = location.city;
                //wait five seconds for API load
                setTimeout(() => {
                    currentCityWeather();
                    fiveDayWeatherForecast(coords);
                }, 5000);
            },                     
            error: function(err){
                $("#err-display").html("<div class='err-notice-bad'>Poor network connectivity, failed to fetch weather updates, refresh.</div>");      
            } 
        });  

        //Update background image depending on weather for the city
        function dynamicWeatherBackground(weatherCondition){
            switch(weatherCondition){
                case "Clear":
                    $("#banner").css("background-image", 'url("./images/banners/clear.jpg")');
                    break;

                case "Clouds":
                    $("#banner").css("background-image", 'url("./images/banners/cloudy.jpg")');
                    break;

                case "Rain":
                    $("#banner").css("background-image", 'url("./images/banners/rain.jpg")');
                    break;

                default:
                    $("#banner").css("background-image", 'url("./images/banners/clear.jpg")');
                    break;
            }
        }
        //Fetch weather information for user current city using openWeatherMap
        function currentCityWeather(){
            const lat = coords.lat;
            const lng = coords.lng;
            const current_city = coords.city;
            if(lat!="" && lng!=""){
                $.ajax({
                    type: "GET",
                    url: "https://api.openweathermap.org/data/3.0/onecall?lat="+lat+"&lon="+lng+"&appid=b0fbe96cfe47ba62973a33ed3abfb1f1",
                    async: true,
                    success: function(r){    
                        if(r["current"]["temp"]!="" || r["current"]["clouds"]!="" || r["timezone"]!="") {
                            $("#temp-level").html("<span id='searched-city-temp'><span id='changeable-temp'>"+r["current"]["temp"]+"</span><sup>o</sup>C</span>");
                            $("#cloudy-level").html("<span>"+r["current"]["clouds"]+"<sup>oktas</sup></span>");
                            $("#pressure-level").html("<span>"+r["current"]["pressure"]+"<sup>atm</sup></span>");
                            $("#humidity-level").html("<span>"+r["current"]["humidity"]+" g/m<sup>2</sup</span>");
                            $("#windy-level").html("<span>"+r["current"]["wind_deg"]+"<sup>km/h</sup</span>");
                            let cityNameArr = r["timezone"].split("/");
                            $(".city-indicator-wrap").html(cityNameArr[1]+" City Weather Information");
                            $("#err-display").hide(200);

                            $("#current-city-temp-level").html("<span><span id='changeable-temp-2'>"+r["current"]["temp"]+"</span><sup>o</sup>C</span>");
                            $("#current-city-cloudy-level").html("<span>"+r["current"]["clouds"]+"<sup>oktas</sup></span>");
                            $("#current-city-pressure-level").html("<span>"+r["current"]["pressure"]+"<sup>atm</sup></span>");
                            $("#current-city-humidity-level").html("<span>"+r["current"]["humidity"]+" g/m<sup>2</sup></span>");
                            $("#current-city-windy-level").html("<span>"+r["current"]["wind_deg"]+"<sup>km/h</sup></span>");
                            dynamicWeatherBackground(r["current"]["weather"][0]["main"]);
                        } else {
                            $("#err-display").html("<div class='err-notice'>Failed to fetch weather updates, refresh.</div>");
                        }
                    }
                });  
            } else $("#err-display").html("<div class='err-notice'>Please wait, loading weather for current city</div>");
        }
        currentCityWeather(coords);

        //Get weather updates for the next consecutive 5 days
        function fiveDayWeatherForecast(coords){
            const lat = coords.lat;
            const lng = coords.lng;
            const current_city = coords.city;
            if(lat!="" && lng!=""){
                $.ajax({
                    type: "GET",
                    url: "https://api.openweathermap.org/data/3.0/onecall?lat="+lat+"&lon="+lng+"&appid=b0fbe96cfe47ba62973a33ed3abfb1f1",
                    async: true,
                    beforeSend:function(){
                    },
                    success: function(r){
                        let focus = r.daily;
                        let focus_view = "";
                        for (const day in focus) {
                            var focusDate = new Date(focus[day]["dt"] * 1000).toDateString();
                            focus_view+='<div class="vb-card-service col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4"><div class="icons"></div><h5 class="service-name-desc"><div class="service-title">'+focusDate+'</div><h5 class="five-day-desc" style="text-align:center;">'+focus[day]["summary"]+'</h5><div class="service-desc" style="text-align: center;"><span class="five-day-update"></span><span class="five-day-update"></span><span class="five-day-update"></div></h5></div>';
                        }
                        $("#five-day-focus-wrapper").html(focus_view);
                    }
                });  
            } else $("#err-display").html("<div class='err-notice'>Please wait, loading weather for current city</div>");
        }

        //Save cityname and weather condition in web browser local storage API
        $(function(){
            $("#fav-city").click(function(){
                //Check if browser supports Local Storage or Not
                const isCityReady = $("#city-indicator-wrap").val();
                const cityTemp = $("#searched-city-temp").val();
                if(isCityReady!=""){
                    if(typeof(Storage)){
                        localStorage.setItem("1", isCityReady+" is "+cityTemp + "Celsius");
                    } else $("#err-display").html("<div class='err-notice'>This browser does not support local storage, update or use another browser like Operamini, Firefox or Google Chrome</div>");
                } else $("#err-display").html("<div class='err-notice'>You can only save a city after searching</div>");          
            });
        });
    
        //Change temperature from celsius to fahrenheit
        $(function(){
            $("#conver-units-btn").click(function(){
                let cityCurrTemp = $("#changeable-temp").text();
                if(cityCurrTemp!=""){
                    let f = (cityCurrTemp * (9/5)) + 32;
                    const fahrenheit = Math.round(f,2);
                    $("#temp-level").html("<span><span class='changeable-temp'>"+fahrenheit+"</span><sup>o</sup>F</span>");
                    $("#current-city-temp-level").html("<span><span class='changeable-temp'>"+fahrenheit+"</span><sup>o</sup>F</span>");
                    $("#err-display").html("<div class='err-notice'>Temperature Units Converted</div>");
                    $("#err-display").fadeOut(5000);
                } else $("#err-display").html("<div class='err-notice'>Can only convert if temperature is given</div>");  
                                   
            });
        });
       
        //Search weather updates for a city
        $(function(){
            $("#search-btn").click(function(){
                const cityNameq = $("#search").val();        
                if(cityNameq!=""){
                    $.ajax({
                        type: "GET",
                        url: "https://api.openweathermap.org/data/2.5/weather?q="+cityNameq+"&appid=b0fbe96cfe47ba62973a33ed3abfb1f1               ",
                        async: true,
                        success: function(r){
                            if(r["main"]["temp"]!="" && r["clouds"]["all"]!="" && r["timezone"]!="") {
                                $("#temp-level").html("<span id='searched-city-temp'><span class='changeable-temp'>"+r["main"]["temp"]+"</span><sup>o</sup>C</span>");
                                $("#cloudy-level").html("<span>"+r["clouds"]["all"]+"<sup>oktas</sup></span>");
                                $("#pressure-level").html("<span>"+r["main"]["pressure"]+"<sup>atm</sup></span>");
                                $("#humidity-level").html("<span>"+r["main"]["humidity"]+"g/m<sup>2</sup></span>");
                                $("#windy-level").html("<span>"+r["wind"]["deg"]+"<sup>km/h</sup></span>");
                                dynamicWeatherBackground(r["current"]["weather"][0]["main"]);
                                let cityNameSearched = r["name"];
                                $(".city-indicator-wrap").html("Weather For: "+cityNameSearched);
                                $("#err-display").hide(200);
                            } else {
                                $("#err-display").html("<div class='err-notice'>Check city name, or network, failed to fetch weather updates, refresh.</div>");
                            }
                        },
                        error: function(err){
                            $("#err-display").html("<div class='err-notice-bad'>Poor network connectivity, failed to fetch weather updates, refresh.</div>");      
                        } 
                    });  
                } else $("#err-display").html("<div clas='err-notice'>Enter City Name To Search</div>");
            });
        });
    </script>
</body>
</html>